<html>
    <head>
    
        <script src="/lib/jquery/jquery.js"></script>
        <script src='http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.3/underscore-min.js'></script>
        
        <script>
        
            var tSample = {
                id: '@somebody',
                tStart: Date.now()-500000,
                tStop: Date.now(),
                tSteps: 5,
                features: {
                    'Writing': [ 0, 0.25, 0.5, 0.5, 0.75, 1.0 ],
                    'Happy': [  0, 0.25, 0, 0, 0  ],
                    'Sad': [  0, 0, 0, 0, 0, 1  ],
                    'Buying': [ 0, 0, 0.25, 0.25, 0 ],
                    'Questioning': [0,0,0,0,0],
                    'Cursing': [0,0,0,0,0],
                    'Linking': [0,0,0,0,0],
                    'Retweeting': [0,0,0,0,0],
                    'Mentioning': [0,0,0,0,0],
                    'Moving': [0,0,0,0,0], //geolocation changes
                    'Laughing': [ 1.0, 0, 0, 0, 0.25 ]                    
                },
                conclusions: [
                    'Person laughs before cursing 60%',
                    'Person is simultaneously questioning and happy 85%',
                ],
                suggestions: [
                    'Person should buy <a href="http://www.amazon.com/gp/product/B001OORMVQ/ref=s9_simh_gw_p147_d1_i4?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=center-2&pf_rd_r=1D1EGERGCVBCF3PMGYS7&pf_rd_t=101&pf_rd_p=1389517282&pf_rd_i=507846">SATA Adapter</a>',
                    'Person should talk to @otherperson'
                ]
            };
            
            function renderFeatureHeading(l) {
                return '<div class="FeatureHeading">' + l + '</div>';
            }
            function renderFeatureCell(v) {
                var g = 255;
                var r = parseInt((1.0-v)*255.0);
                var b = parseInt((1.0-v)*255.0);
                var bg = 'rgb(' + r + ',' + g + ',' + b +')';
                return '<div class="featureCell" style="background-color: ' + bg + '">' + v + '</div>';
            }
            
            function render(x) {
                var d = $('<div></div>');
                d.append('<h2>' + x.id + '</h2>');
                d.append(new Date(x.tStart) + ' <i>to</i> ' + new Date(x.tStop));
                _.each(x.features, function(v, k) {
                    var f = $('<div></div>');
                    f.append(renderFeatureHeading(k));
                    for (var i = 0; i < x.tSteps; i++) {
                        f.append(renderFeatureCell(v[i]));
                    }
                    f.append('<br/>');
                    
                    
                    d.append(f);
                    
                });
                d.append('<h3>Conclusions</h3><ul>');
                _.each(x.conclusions, function(c) {
                    d.append('<li>' + c + '</li>');
                });
                d.append('</ul>');
                
                d.append('<h3>Suggestions</h3><ul>');
                _.each(x.suggestions, function(c) {
                    d.append('<li>' + c + '</li>');                    
                });
                d.append('</ul>');
                
                return d;
            }
            
            $(document).ready(function(){
                $('body').append(render(tSample));
            });
        </script>
        <style>
            body {
                font-family: arial, sans;
            }
            .FeatureHeading {
                width: 8em;
                float: left;
            }
            .featureCell {
                width: 4em;
                float: left;
                text-align: center;
            }
        </style>
    </head>    
    
    <body>
        <h1>Noosphere Analysis</h1>
    </body>
</html>